import{H as T,r as a,j as e,B as h,C as v,T as j,P as w,O as A,Q as I}from"./index-N064zUTy.js";import{A as E,C as F}from"./Container-CaC0JH33.js";import{T as u}from"./TextField-Duq-J_5F.js";import{A as O}from"./Autocomplete-9fvS_lDN.js";import{T as k,a as H,b as P,c as g,d as r,e as B}from"./TableRow-BaK27bfM.js";import"./Select-xO9CAVna.js";import"./Chip-C_4sFtdR.js";const Q=()=>{const{employeeId:d}=T(),[x,y]=a.useState([]),[C,n]=a.useState(!0),[m,o]=a.useState(null),[i,p]=a.useState(""),[l,f]=a.useState(""),[c,b]=a.useState(""),[D,S]=a.useState([]);return a.useEffect(()=>{const t=new Date,s=new Date(t.getFullYear(),t.getMonth()-1,t.getDate());p(s.toISOString().split("T")[0]),f(new Date().toISOString().split("T")[0])},[]),a.useEffect(()=>{(async()=>{try{const s=await A();s.status==="success"&&s.data?S(s.data):o(s.message||"Failed to fetch customer options.")}catch(s){o(s instanceof Error?s.message:"An unexpected error occurred while fetching customer options.")}})()},[]),a.useEffect(()=>{(async()=>{if(!d){o("Employee ID not available."),n(!1);return}n(!0),o(null);try{const s=await I(i,l,c);y(s)}catch(s){o(s.message||"Failed to fetch sales activity history.")}finally{n(!1)}})()},[d,i,l,c]),C?e.jsx(h,{sx:{display:"flex",justifyContent:"center",alignItems:"center",height:"80vh"},children:e.jsx(v,{})}):m?e.jsx(h,{sx:{display:"flex",justifyContent:"center",alignItems:"center",height:"80vh"},children:e.jsx(E,{severity:"error",children:m})}):e.jsxs(F,{maxWidth:"lg",sx:{mt:2},children:[e.jsx(j,{variant:"h4",component:"h1",gutterBottom:!0,children:"Sales Activity History"}),e.jsxs(h,{sx:{mb:1,display:"flex",gap:2,flexWrap:"wrap"},children:[e.jsx(u,{label:"From Date",type:"date",value:i,onChange:t=>p(t.target.value),InputLabelProps:{shrink:!0}}),e.jsx(u,{label:"To Date",type:"date",value:l,onChange:t=>f(t.target.value),InputLabelProps:{shrink:!0}}),e.jsx(O,{options:D,value:c,onChange:(t,s)=>{b(s||"")},renderInput:t=>e.jsx(u,{...t,label:"Customer"}),sx:{flexGrow:1}})]}),x.length===0?e.jsx(j,{variant:"subtitle1",sx:{textAlign:"center",mt:4},children:"No activities found for the selected criteria."}):e.jsx(k,{component:w,children:e.jsxs(H,{sx:{minWidth:650},"aria-label":"sales activity table",children:[e.jsx(P,{children:e.jsxs(g,{children:[e.jsx(r,{children:"Date"}),e.jsx(r,{children:"Customer"}),e.jsx(r,{children:"Check-in"}),e.jsx(r,{children:"Check-out"}),e.jsx(r,{children:"Duration (min)"}),e.jsx(r,{children:"Status"})]})}),e.jsx(B,{children:x.map(t=>e.jsxs(g,{sx:{"&:last-child td, &:last-child th":{border:0}},children:[e.jsx(r,{component:"th",scope:"row",children:t.Date}),e.jsx(r,{children:t.Customer}),e.jsx(r,{children:t.Checkin}),e.jsx(r,{children:t.Checkout}),e.jsx(r,{children:t.Duration}),e.jsx(r,{children:t.Status})]},`${t.Date}-${t.Checkin}`))})]})})]})};export{Q as default};
