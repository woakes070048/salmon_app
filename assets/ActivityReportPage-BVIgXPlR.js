import{H as v,r as n,i as k,j as e,B as i,C as A,T as o,P as I,O as E,Q as F}from"./index-DHtaTAx5.js";import{u as O}from"./useMediaQuery-BmQQ1WCQ.js";import{A as P,C as H}from"./Container-H39qN3_s.js";import{T as p}from"./TextField-q3GTwlon.js";import{A as B}from"./Autocomplete-BZBTvpem.js";import{T as M,a as R,b as $,c as C,d as r,e as L}from"./TableRow-BDTyuO8X.js";import{C as W,a as _,b as Q}from"./CardHeader-ByO6tpI5.js";import{C as z}from"./Chip-DaUSEYqM.js";import"./Select-rr9m8HoX.js";const G=({activity:a})=>e.jsxs(W,{sx:{mb:2},children:[e.jsx(_,{title:a.Customer,subheader:a.Date,titleTypographyProps:{variant:"h6"}}),e.jsxs(Q,{children:[e.jsxs(i,{sx:{display:"flex",justifyContent:"space-between",mb:1},children:[e.jsx(o,{variant:"body2",children:"Check-in:"}),e.jsx(o,{variant:"body2",children:a.Checkin})]}),e.jsxs(i,{sx:{display:"flex",justifyContent:"space-between",mb:1},children:[e.jsx(o,{variant:"body2",children:"Check-out:"}),e.jsx(o,{variant:"body2",children:a.Checkout})]}),e.jsxs(i,{sx:{display:"flex",justifyContent:"space-between",mb:1},children:[e.jsx(o,{variant:"body2",children:"Duration (min):"}),e.jsx(o,{variant:"body2",children:a.Duration})]}),e.jsxs(i,{sx:{display:"flex",justifyContent:"space-between"},children:[e.jsx(o,{variant:"body2",children:"Status:"}),e.jsx(z,{label:a.Status,color:a.Status==="Completed"?"success":"default",size:"small"})]})]})]}),te=()=>{const{employeeId:a}=v(),[c,b]=n.useState([]),[y,h]=n.useState(!0),[m,l]=n.useState(null),[d,j]=n.useState(""),[u,f]=n.useState(""),[x,g]=n.useState(""),[D,S]=n.useState([]);n.useEffect(()=>{const t=new Date,s=new Date(t.getFullYear(),t.getMonth()-1,t.getDate());j(s.toISOString().split("T")[0]),f(new Date().toISOString().split("T")[0])},[]),n.useEffect(()=>{(async()=>{try{const s=await E();s.status==="success"&&s.data?S(s.data):l(s.message||"Failed to fetch customer options.")}catch(s){l(s instanceof Error?s.message:"An unexpected error occurred while fetching customer options.")}})()},[]),n.useEffect(()=>{(async()=>{if(!a){l("Employee ID not available."),h(!1);return}h(!0),l(null);try{const s=await F(d,u,x);b(s)}catch(s){l(s.message||"Failed to fetch sales activity history.")}finally{h(!1)}})()},[a,d,u,x]);const T=k(),w=O(T.breakpoints.down("sm"));return y?e.jsx(i,{sx:{display:"flex",justifyContent:"center",alignItems:"center",height:"80vh"},children:e.jsx(A,{})}):m?e.jsx(i,{sx:{display:"flex",justifyContent:"center",alignItems:"center",height:"80vh"},children:e.jsx(P,{severity:"error",children:m})}):e.jsxs(H,{maxWidth:"lg",sx:{mt:2},children:[e.jsx(o,{variant:"h4",component:"h1",gutterBottom:!0,children:"Activity Report"}),e.jsxs(i,{sx:{mb:1,display:"flex",gap:2,flexWrap:"wrap"},children:[e.jsx(p,{label:"From Date",type:"date",value:d,onChange:t=>j(t.target.value),InputLabelProps:{shrink:!0}}),e.jsx(p,{label:"To Date",type:"date",value:u,onChange:t=>f(t.target.value),InputLabelProps:{shrink:!0}}),e.jsx(B,{options:D,value:x,onChange:(t,s)=>{g(s||"")},renderInput:t=>e.jsx(p,{...t,label:"Customer"}),sx:{flexGrow:1}})]}),c.length===0?e.jsx(o,{variant:"subtitle1",sx:{textAlign:"center",mt:4},children:"No activities found for the selected criteria."}):w?e.jsx(i,{children:c.map(t=>e.jsx(G,{activity:t},`${t.Date}-${t.Checkin}`))}):e.jsx(M,{component:I,sx:{overflowX:"auto"},children:e.jsxs(R,{sx:{minWidth:650},"aria-label":"sales activity table",children:[e.jsx($,{children:e.jsxs(C,{children:[e.jsx(r,{children:"Date"}),e.jsx(r,{children:"Customer"}),e.jsx(r,{children:"Check-in"}),e.jsx(r,{children:"Check-out"}),e.jsx(r,{children:"Duration (min)"}),e.jsx(r,{children:"Status"})]})}),e.jsx(L,{children:c.map(t=>e.jsxs(C,{sx:{"&:last-child td, &:last-child th":{border:0}},children:[e.jsx(r,{component:"th",scope:"row",children:t.Date}),e.jsx(r,{children:t.Customer}),e.jsx(r,{children:t.Checkin}),e.jsx(r,{children:t.Checkout}),e.jsx(r,{children:t.Duration}),e.jsx(r,{children:t.Status})]},`${t.Date}-${t.Checkin}`))})]})})]})};export{te as default};
