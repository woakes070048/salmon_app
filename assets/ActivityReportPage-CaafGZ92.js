import{H as k,r as a,i as A,j as e,B as o,C as I,T as n,P as E,O as F,Q as O}from"./index-BC3UxqoT.js";import{u as P}from"./useMediaQuery-CchYqtpt.js";import{A as H,C as B}from"./Container-D5zBg6sZ.js";import{T as x}from"./TextField-DRiEz01N.js";import{A as M,T as R,a as $,b as L,c as C,d as r,e as W}from"./TableRow-qW0J2Qqb.js";import{C as _,a as Q,b as z}from"./CardHeader-Cx3FrDr2.js";import{C as G}from"./Chip-42AKOM23.js";import"./Select-Vgkz5MIo.js";const ee=()=>{const{employeeId:p}=k(),[l,b]=a.useState([]),[y,c]=a.useState(!0),[m,i]=a.useState(null),[h,j]=a.useState(""),[d,f]=a.useState(""),[u,g]=a.useState(""),[D,S]=a.useState([]);a.useEffect(()=>{const t=new Date,s=new Date(t.getFullYear(),t.getMonth()-1,t.getDate());j(s.toISOString().split("T")[0]),f(new Date().toISOString().split("T")[0])},[]),a.useEffect(()=>{(async()=>{try{const s=await F();s.status==="success"&&s.data?S(s.data):i(s.message||"Failed to fetch customer options.")}catch(s){i(s instanceof Error?s.message:"An unexpected error occurred while fetching customer options.")}})()},[]),a.useEffect(()=>{(async()=>{if(!p){i("Employee ID not available."),c(!1);return}c(!0),i(null);try{const s=await O(h,d,u);b(s)}catch(s){i(s.message||"Failed to fetch sales activity history.")}finally{c(!1)}})()},[p,h,d,u]);const T=A(),w=P(T.breakpoints.down("sm"));if(y)return e.jsx(o,{sx:{display:"flex",justifyContent:"center",alignItems:"center",height:"80vh"},children:e.jsx(I,{})});if(m)return e.jsx(o,{sx:{display:"flex",justifyContent:"center",alignItems:"center",height:"80vh"},children:e.jsx(H,{severity:"error",children:m})});const v=({activity:t})=>e.jsxs(_,{sx:{mb:2},children:[e.jsx(Q,{title:t.Customer,subheader:t.Date,titleTypographyProps:{variant:"h6"}}),e.jsxs(z,{children:[e.jsxs(o,{sx:{display:"flex",justifyContent:"space-between",mb:1},children:[e.jsx(n,{variant:"body2",children:"Check-in:"}),e.jsx(n,{variant:"body2",children:t.Checkin})]}),e.jsxs(o,{sx:{display:"flex",justifyContent:"space-between",mb:1},children:[e.jsx(n,{variant:"body2",children:"Check-out:"}),e.jsx(n,{variant:"body2",children:t.Checkout})]}),e.jsxs(o,{sx:{display:"flex",justifyContent:"space-between",mb:1},children:[e.jsx(n,{variant:"body2",children:"Duration (min):"}),e.jsx(n,{variant:"body2",children:t.Duration})]}),e.jsxs(o,{sx:{display:"flex",justifyContent:"space-between"},children:[e.jsx(n,{variant:"body2",children:"Status:"}),e.jsx(G,{label:t.Status,color:t.Status==="Completed"?"success":"default",size:"small"})]})]})]});return e.jsxs(B,{maxWidth:"lg",sx:{mt:2},children:[e.jsx(n,{variant:"h4",component:"h1",gutterBottom:!0,children:"Activity Report"}),e.jsxs(o,{sx:{mb:1,display:"flex",gap:2,flexWrap:"wrap"},children:[e.jsx(x,{label:"From Date",type:"date",value:h,onChange:t=>j(t.target.value),InputLabelProps:{shrink:!0}}),e.jsx(x,{label:"To Date",type:"date",value:d,onChange:t=>f(t.target.value),InputLabelProps:{shrink:!0}}),e.jsx(M,{options:D,value:u,onChange:(t,s)=>{g(s||"")},renderInput:t=>e.jsx(x,{...t,label:"Customer"}),sx:{flexGrow:1}})]}),l.length===0?e.jsx(n,{variant:"subtitle1",sx:{textAlign:"center",mt:4},children:"No activities found for the selected criteria."}):w?e.jsx(o,{children:l.map(t=>e.jsx(v,{activity:t},`${t.Date}-${t.Checkin}`))}):e.jsx(R,{component:E,sx:{overflowX:"auto"},children:e.jsxs($,{sx:{minWidth:650},"aria-label":"sales activity table",children:[e.jsx(L,{children:e.jsxs(C,{children:[e.jsx(r,{children:"Date"}),e.jsx(r,{children:"Customer"}),e.jsx(r,{children:"Check-in"}),e.jsx(r,{children:"Check-out"}),e.jsx(r,{children:"Duration (min)"}),e.jsx(r,{children:"Status"})]})}),e.jsx(W,{children:l.map(t=>e.jsxs(C,{sx:{"&:last-child td, &:last-child th":{border:0}},children:[e.jsx(r,{component:"th",scope:"row",children:t.Date}),e.jsx(r,{children:t.Customer}),e.jsx(r,{children:t.Checkin}),e.jsx(r,{children:t.Checkout}),e.jsx(r,{children:t.Duration}),e.jsx(r,{children:t.Status})]},`${t.Date}-${t.Checkin}`))})]})})]})};export{ee as default};
